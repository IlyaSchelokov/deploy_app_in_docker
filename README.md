# Финальное задание по Docker
## Deploy приложения Librespeed в Docker с использованием EFK стека
### 1. Требования к реализации:
1.1. К запущенному приложению:
   
   - Приложение должно быть запущено в frontend режиме с хранением телеметрии, обфускацией ID и без редактировния IP адресов
   - Конфигурация должна производиться исключительно через переменные окружения
   - Отправлять логи в EFK средствами Docker
   - Образ должен собираться из docker-compose файла
   - Конфигурационный файл серверов должен подключаться как volume

1.2. К Dockerfile:
   - Образ не должен содержать конфигурационный файл серверов
   - Образ должен кешировать как можно больше при минимальном количестве шагов

1.3. К запущенной базе данных:
   - Не забудьте инициализировать структуру базы из sql-скрипта
   - Должна использоваться БД - My SQL
   - Хранилище БД должно подключаться как volume

1.4. К запущенному Proxy:
   - В качестве прокcи нужно использовать nginx
   - Отправлять логи в EFK средствами Docker
   - Должно слушать порт 8080 на localhost запущенной машины
   - Перенаправлять запросы в приложение
   - Адрес, с которого производится запрос, должен пробрасываться в приложение через заголовок

1.5. К запущенному ElasticSearch:
   - Конфигурация должна производиться исключительно через переменные окружения
   - Разрешенный объем используемой оперативной памяти - 1024 MiB (через переменные java)

1.6. К запущенному Fluentd:
   - Должен слушать порт на хостовых машинах
   - Должен отправлять логи в ElasticSearch кусками по 10 MiB
   - Конфигурационный файл должен храниться в файле и подключаться внутрь контейнера как volume
   - Параметры подключения к ElasticSearch должны передаваться через переменные окружения в конфигурационный файл
   - Не должен отправлять собственные логи
   - Хранить собственные логи в формате JSON в файлах по 10 MiB с ротацией в 5 файлов

1.7. К запущенной Kibana:
   - Конфигурация должна производиться исключительно через переменные окружения
   - Разрешенный объем используемой оперативной памяти - 512 MiB
   - Отправлять логи в EFK средствами Docker
   - Должна слушать порт 5601 на localhost запущенной машины для доступа к Kibana
   - Должна подключаться к ElasticSearch

### 2. Требования к оформлению и содержанию репозитория:

Должны присутствовать 2 docker-compose файла:
- app.compose.yml - запуск предложенного приложения с зависимостями - базой данных, прокси и средой исполнения, указанных в присланных заданиях
- efk.compose.yml - EFK-стек для сбора логов с приложений

Должен присутствовать Dockerfile, используемый для сборки образа с приложением

### 3. Развертывание:
```bash
docker-compose -f efk.compose.yml up -d --build
docker-compose -f app.compose.yml up -d --build
```

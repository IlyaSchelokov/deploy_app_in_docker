<system>
  log_level info
  suppress_repeated_stacktrace true
  <log>
    format json
    path /fluentd/log/fluentd.log
    rotate_age 5
    rotate_size 10M
  </log>
</system>

<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

<match **>
    @type elasticsearch
    host "#{ENV['ELASTICSEARCH_HOST']}"
    port "#{ENV['ELASTICSEARCH_PORT']}"
    index_name voting-%Y.%m.%d
    type_name _doc

  # Настройки буферизации (чанки по 10 MiB)
  buffer_chunk_limit 10M
</match>
